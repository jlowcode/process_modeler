define(["jquery","fab/list-plugin"],function(e,t){return new Class({Extends:t,initialize:function(e){this.parent(e)},buttonAction:function(){var t,n,i,l=[];if(this.listform.getElements("input[name^=ids]").each(function(e){!1!==e.get("value")&&!1!==e.checked&&l.push(e.get("value"))}),1===l.length){e("#processModelerModal").length&&(e("#processModelerModal").remove(),e("#buttonSelected").remove(),e("#xml_bpmn").remove());var s=this;e.ajax({url:Fabrik.liveSite+"index.php",method:"POST",data:{option:"com_fabrik",format:"raw",task:"plugin.pluginAjax",plugin:"process_modeler",method:"verifyExistsXml",g:"list",elementBpmn:s.options.elementBpmn,table:s.options.table,rowId:l[0]}}).done(function(e){i=document.getElement("body"),(t=document.createElement("input")).setAttribute("type","hidden"),t.setAttribute("id","xml_bpmn"),t.setAttribute("value",JSON.parse(e)),(n=document.createElement("input")).setAttribute("type","hidden"),n.setAttribute("id","svg_bpmn"),i.appendChild(t),i.appendChild(n),s.createModal(),document.getElementById("buttonClicked").setAttribute("value",l[0]),s.openModal()})}},createModal:function(){var t=document.createElement("div");t.setAttribute("class","process_modeler-modal"),t.setAttribute("id","processModelerModal");var n=document.createElement("div");n.setAttribute("class","process_modeler-modal-content");var i=document.createElement("div");i.setAttribute("class","process_modeler-modal-header");var l=document.createElement("span");l.setAttribute("class","process_modeler-modal-close"),l.innerHTML="&times;";var s=document.createElement("h2");s.innerHTML="Modelagem",i.appendChild(l),i.appendChild(s);var o=document.createElement("div");o.setAttribute("class","process_modeler-modal-body");var d=document.createElement("div");d.innerHTML='<div class="content" id="js-drop-zone">\n<div class="message intro">\n                    <div class="note">\n                        Solte um arquivo .bpmn ou <a id="js-create-diagram" href>crie um novo diagrama</a> para iniciar.\n                    </div>\n                </div><div class="message error">\n      <div class="note">\n        <p>Ooops, we could not display the BPMN 2.0 diagram.</p>\n\n        <div class="details">\n          <span>cause of the problem</span>\n          <pre></pre>\n        </div>\n      </div>\n    </div>\n    <div class="canvas" id="js-canvas"></div>\n  </div>\n',o.appendChild(d);var a=document.createElement("div");a.setAttribute("class","process_modeler-modal-footer");var r=document.createElement("button");r.setAttribute("class","btn btn-default"),r.setAttribute("id","saveButton"),r.setAttribute("style","margin: 10px"),r.innerHTML="Salvar",r.onclick=(()=>{var t=document.getElementById("xml_bpmn").value,n=document.getElementById("svg_bpmn").value,i=document.getElementById("buttonClicked").value;e.ajax({url:Fabrik.liveSite+"index.php",method:"POST",data:{option:"com_fabrik",format:"raw",task:"plugin.pluginAjax",plugin:"process_modeler",method:"updateXml",g:"list",listid:this.options.listid,elementBpmn:this.options.elementBpmn,elementStatus:this.options.elementStatus,statusValue:this.options.statusValue,table:this.options.table,rowId:i,xml:t,svg:n,m_element_name:this.options.m_element_name,m_folder:this.options.m_folder}}).done(function(e){window.location.reload(!0)})}),a.appendChild(r),n.appendChild(i),n.appendChild(o),n.appendChild(a),t.appendChild(n);var m=document.createElement("input");m.setAttribute("type","hidden"),m.setAttribute("id","buttonClicked");var p=document.getElement("body"),c=document.getElement("head"),u=document.createElement("link");u.setAttribute("href",this.options.url+"plugins/fabrik_list/process_modeler/modal/modal.css"),u.setAttribute("rel","stylesheet");var b=document.createElement("link"),v=document.createElement("link"),h=document.createElement("link");b.setAttribute("rel","stylesheet"),v.setAttribute("rel","stylesheet"),h.setAttribute("rel","stylesheet"),b.setAttribute("href",Fabrik.liveSite+"plugins/fabrik_list/process_modeler/modeler/public/vendor/bpmn-js/assets/diagram-js.css"),v.setAttribute("href",Fabrik.liveSite+"plugins/fabrik_list/process_modeler/modeler/public/vendor/bpmn-js/assets/bpmn-font/css/bpmn-embedded.css"),h.setAttribute("href",Fabrik.liveSite+"plugins/fabrik_list/process_modeler/modeler/public/css/app.css"),c.appendChild(b),c.appendChild(v),c.appendChild(h);var g=document.createElement("script");g.setAttribute("src",Fabrik.liveSite+"plugins/fabrik_list/process_modeler/modeler/public/app.js"),p.appendChild(t),p.appendChild(m),c.appendChild(u),c.appendChild(g)},openModal:function(){var e=document.getElementById("processModelerModal"),t=document.getElement("body");t.style.overflowY="hidden",e.style.display="block",document.getElementsByClassName("process_modeler-modal-close")[0].onclick=function(){e.style.display="none",t.style.overflowY="auto"},window.onclick=function(n){n.target==e&&(e.style.display="none",t.style.overflowY="auto")}}})});
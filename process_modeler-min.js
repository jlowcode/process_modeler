define(["jquery","fab/list-plugin"],function(e,t){var n=new Class({Extends:t,initialize:function(e){this.parent(e)},buttonAction:function(){var t,n,l,i,s=[];if(this.listform.getElements("input[name^=ids]").each(function(e){!1!==e.get("value")&&!1!==e.checked&&s.push(e.get("value"))}),1===s.length){e("#processModelerModal").length&&(e("#processModelerModal").remove(),e("#buttonSelected").remove(),e("#xml_bpmn").remove());var o=this;e.ajax({url:Fabrik.liveSite+"index.php",method:"POST",data:{option:"com_fabrik",format:"raw",task:"plugin.pluginAjax",plugin:"process_modeler",method:"verifyExistsXml",g:"list",elementBpmn:o.options.elementBpmn,table:o.options.table,rowId:s[0]}}).done(function(e){i=document.getElement("body"),n=document.createElement("input"),n.setAttribute("type","hidden"),n.setAttribute("id","xml_bpmn"),n.setAttribute("value",JSON.parse(e)),l=document.createElement("input"),l.setAttribute("type","hidden"),l.setAttribute("id","svg_bpmn"),i.appendChild(n),i.appendChild(l),o.createModal(),t=document.getElementById("buttonClicked"),t.setAttribute("value",s[0]),o.openModal()})}},createModal:function(){var t=document.createElement("div");t.setAttribute("class","process_modeler-modal"),t.setAttribute("id","processModelerModal");var n=document.createElement("div");n.setAttribute("class","process_modeler-modal-content");var l=document.createElement("div");l.setAttribute("class","process_modeler-modal-header");var i=document.createElement("span");i.setAttribute("class","process_modeler-modal-close"),i.innerHTML="&times;";var s=document.createElement("h2");s.innerHTML="Modelagem",l.appendChild(i),l.appendChild(s);var o=document.createElement("div");o.setAttribute("class","process_modeler-modal-body");var d=document.createElement("div");d.innerHTML='<div class="content" id="js-drop-zone">\n<div class="message intro">\n                    <div class="note">\n                        Solte um arquivo .bpmn ou <a id="js-create-diagram" href>crie um novo diagrama</a> para iniciar.\n                    </div>\n                </div><div class="message error">\n      <div class="note">\n        <p>Ooops, we could not display the BPMN 2.0 diagram.</p>\n\n        <div class="details">\n          <span>cause of the problem</span>\n          <pre></pre>\n        </div>\n      </div>\n    </div>\n    <div class="canvas" id="js-canvas"></div>\n  </div>\n',o.appendChild(d);var a=document.createElement("div");a.setAttribute("class","process_modeler-modal-footer");var r=document.createElement("button");r.setAttribute("class","btn btn-default"),r.setAttribute("id","saveButton"),r.setAttribute("style","margin: 5px"),r.innerHTML="Salvar",r.onclick=(()=>{var t=document.getElementById("xml_bpmn").value,n=document.getElementById("svg_bpmn").value,l=document.getElementById("buttonClicked").value,i=this;e.ajax({url:Fabrik.liveSite+"index.php",method:"POST",data:{option:"com_fabrik",format:"raw",task:"plugin.pluginAjax",plugin:"process_modeler",method:"updateXml",g:"list",listid:i.options.listid,elementBpmn:i.options.elementBpmn,elementStatus:i.options.elementStatus,statusValue:i.options.statusValue,table:i.options.table,rowId:l,xml:t,svg:n,m_element_name:i.options.m_element_name,m_folder:i.options.m_folder}}).done(function(e){window.location.reload(!0)})}),a.appendChild(r),n.appendChild(l),n.appendChild(o),n.appendChild(a),t.appendChild(n);var m=document.createElement("input");m.setAttribute("type","hidden"),m.setAttribute("id","buttonClicked");var p=document.getElement("body"),c=document.getElement("head"),u=document.createElement("link");u.setAttribute("href",this.options.url+"plugins/fabrik_list/process_modeler/modal/modal.css"),u.setAttribute("rel","stylesheet");var b=document.createElement("link"),v=document.createElement("link"),h=document.createElement("link");b.setAttribute("rel","stylesheet"),v.setAttribute("rel","stylesheet"),h.setAttribute("rel","stylesheet"),b.setAttribute("href",Fabrik.liveSite+"plugins/fabrik_list/process_modeler/modeler/public/vendor/bpmn-js/assets/diagram-js.css"),v.setAttribute("href",Fabrik.liveSite+"plugins/fabrik_list/process_modeler/modeler/public/vendor/bpmn-js/assets/bpmn-font/css/bpmn-embedded.css"),h.setAttribute("href",Fabrik.liveSite+"plugins/fabrik_list/process_modeler/modeler/public/css/app.css"),c.appendChild(b),c.appendChild(v),c.appendChild(h);var g=document.createElement("script");g.setAttribute("src",Fabrik.liveSite+"plugins/fabrik_list/process_modeler/modeler/public/app.js"),p.appendChild(t),p.appendChild(m),c.appendChild(u),c.appendChild(g)},openModal:function(){var e=document.getElementById("processModelerModal"),t=document.getElement("body");t.style.overflowY="hidden",e.style.display="block";var n=document.getElementsByClassName("process_modeler-modal-close")[0];n.onclick=function(){e.style.display="none",t.style.overflowY="auto"},window.onclick=function(n){n.target==e&&(e.style.display="none",t.style.overflowY="auto")}}});return n});